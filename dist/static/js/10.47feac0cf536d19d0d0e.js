webpackJsonp([10],{"9H3s":function(e,t){},gBGn:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("aA9S"),a=r.n(s),o=[{title:"资源名称",key:"resourceLabel",dataIndex:"resourceLabel"},{dataIndex:"id",title:"资源ID",key:"id"},{title:"资源类型",dataIndex:"resourceType",key:"resourceType"},{title:"状态",key:"resourceStatus",dataIndex:"resourceStatus",scopedSlots:{customRender:"resourceStatus"}},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],i={name:"resourceAllocationList",components:{BTextarea:r("EscQ").a},data:function(){return{data:[],columns:o,searchObj:{resourceLabel:""},pagination:{showLessItems:!0,pageSizeOptions:["10","20","30"],showSizeChanger:!0,pageSize:10,current:1,hideOnSinglePage:!1,total:0},visible:!1,resform:{resourceLabel:"",resourceType:void 0,connectTimeout:10,configuration:{},host:"",methods:"POST",headers:{},port:"",connectPoolSize:1e3,username:"",password:"",virtualHost:"",keepLive:0,metadataUpdateTime:60,reqTimeout:1e3,compressionType:void 0,metaUpdateTs:"",bufferSize:0,batchSize:0},headerArr:[],rules:{resourceLabel:[{required:!0,message:"请输入资源名称",trigger:"blur"}],resourceType:[{required:!0,message:"请选择资源类型",trigger:"blur"}],host:[{required:!0,message:"请输入地址",trigger:"change"}],connectTimeout:[{required:!1,message:"请输入超时时间",trigger:"change"}],password:[{validator:this.$validator.checkCode,message:"不可输入中文",trigger:["blur","change"]}]},resourceList:[{title:"RabbitMQ",key:"RABBIT"},{title:"Kafka",key:"KAFKA"},{title:"HTTP编码",key:"HTTP"}],resTitle:"创建资源",isEdit:!1,resInfo:{},detailVisible:!1,resDetail:{}}},created:function(){this.getList()},methods:{tableChange:function(e){this.pagination.pageSize=e.pageSize,this.pagination.current=e.current,this.pagination.total=e.total,this.getList()},getList:function(){var e=this,t={resourceLabel:this.searchObj.resourceLabel,page:this.pagination.current,pageSize:this.pagination.pageSize};this.$api.getResourceList(t).then(function(t){var r=t.data;e.pagination.total=r.total,e.pagination.pageSize=r.size,e.pagination.current=r.current;var s=r.records;e.data=s})},addHeader:function(){this.headerArr.push({key:"",value:""})},deleteHeader:function(e){var t=this;this.headerArr.map(function(r,s){r===e&&t.headerArr.splice(s,1)})},showModal:function(){this.visible=!0,this.isEdit=!1,this.resTitle="创建资源",this.resform={connectTimeout:10,methods:"POST",keepLive:0,metadataUpdateTime:60,bufferSize:0,batchSize:0},this.headerArr=[]},handleOk:function(){this.isEdit?this.putReaource():this.postAddResource()},editResource:function(e){var t=this;this.visible=!0,this.isEdit=!0,this.resTitle="修改资源",this.getInfo(e.id),setTimeout(function(){t.resform=a()({},t.eencapsulationFormDetail(t.resform,t.resInfo))},500)},closeHand:function(){this.visible=!1,this.$refs.resForm.resetFields()},postAddResource:function(){var e=this,t={resourceLabel:"",resourceType:void 0,configuration:{}};this.encapsulationForm(t),this.$refs.resForm.validate(function(r){r&&e.$api.postResource(t).then(function(t){e.visible=!1,e.getList()})})},encapsulationForm:function(e){switch(this.resform.resourceType){case"HTTP":var t={};this.headerArr.map(function(e){t[e.key]=e.value}),this.resform.headers=t,a()(e,{resourceType:this.resform.resourceType,connectTimeout:this.resform.connectTimeout,configuration:{resourceType:this.resform.resourceType,host:this.resform.host,headers:this.resform.headers},resourceLabel:this.resform.resourceLabel});break;case"RABBIT":a()(e,{resourceType:this.resform.resourceType,connectTimeout:this.resform.connectTimeout,resourceLabel:this.resform.resourceLabel,configuration:{resourceType:this.resform.resourceType,host:this.resform.host,port:this.resform.port,connectPoolSize:this.resform.connectPoolSize,username:this.resform.username,password:this.resform.password,connectTimeout:this.resform.connectTimeout,virtualHost:this.resform.virtualHost,keepLive:this.resform.keepLive}});break;case"KAFKA":a()(e,{resourceType:this.resform.resourceType,resourceLabel:this.resform.resourceLabel,configuration:{resourceType:this.resform.resourceType,host:this.resform.host,metadataUpdateTime:this.resform.metadataUpdateTime,reqTimeout:this.resform.reqTimeout,connectTimeOut:this.resform.connectTimeOut,compressionType:this.resform.compressionType,metaUpdateTs:this.resform.metaUpdateTs,bufferSize:this.resform.bufferSize,username:this.resform.username,password:this.resform.password,batchSize:this.resform.batchSize}})}return e},eencapsulationFormDetail:function(e,t){switch(t.resourceType){case"HTTP":var r=[],s=t.configuration.headers;for(var o in s){var i={};a()(i,{key:o,value:s[o]}),r.push(i)}this.headerArr=r,a()(e,{resourceType:t.resourceType,resourceLabel:t.resourceLabel,host:t.configuration.host,headers:this.headerArr});break;case"KAFKA":a()(e,{resourceType:t.resourceType,resourceLabel:t.resourceLabel,host:t.configuration.host,username:t.configuration.username,password:t.configuration.password,metadataUpdateTime:t.configuration.metadataUpdateTime,reqTimeout:t.configuration.reqTimeout,connectTimeOut:t.configuration.connectTimeOut,compressionType:t.configuration.compressionType,metaUpdateTs:t.configuration.metaUpdateTs,bufferSize:t.configuration.bufferSize,batchSize:t.configuration.batchSize});break;case"RABBIT":a()(e,{resourceType:t.resourceType,resourceLabel:t.resourceLabel,host:t.configuration.host,port:t.configuration.port,connectPoolSize:t.configuration.connectPoolSize,username:t.configuration.username,password:t.configuration.password,connectTimeout:t.configuration.connectTimeout,virtualHost:t.configuration.virtualHost,keepLive:t.configuration.keepLive})}return e},putReaource:function(){var e=this,t={id:this.resInfo.id,resourceLabel:"",resourceType:"",configuration:{},description:""};this.encapsulationForm(t),this.$refs.resForm.validate(function(r){r&&e.$api.putResourceInfo(t).then(function(t){e.visible=!1,e.getList()})})},onSearch:function(){this.getList()},getInfo:function(e){var t=this;this.$api.getResourceInfo(e).then(function(e){t.resInfo=e.data})},changeStatus:function(e){var t=this,r={resourceId:e.id,resourceStatus:!e.resourceStatus};this.$api.putResourceStatus(r).then(function(e){t.getList()})},listDetails:function(e){var t=this;this.detailVisible=!0,this.getInfo(e.id),setTimeout(function(){t.resDetail=t.resInfo,t.eencapsulationFormDetail(t.resDetail,t.resInfo)},500)},detailsHandleOk:function(){this.detailVisible=!1},deleteCancel:function(e){var t=this;this.$api.deleteResource(e).then(function(e){t.getList()})},goDetail:function(){this.$router.push({path:"/productDetatils"})}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._m(0),e._v(" "),r("div",{staticClass:"table-content"},[r("div",{staticClass:"table-title"},[r("a-button",{attrs:{type:"primary"},on:{click:e.showModal}},[r("a-icon",{attrs:{type:"plus"}}),e._v(" 新建资源")],1),e._v(" "),r("a-input-search",{staticStyle:{width:"200px",margin:"0 20px"},attrs:{allowClear:"",placeholder:"请输入资源名称搜索"},on:{blur:e.onSearch,search:e.onSearch},model:{value:e.searchObj.resourceLabel,callback:function(t){e.$set(e.searchObj,"resourceLabel",t)},expression:"searchObj.resourceLabel"}})],1),e._v(" "),r("div",{staticClass:"table-box"},[r("a-table",{attrs:{columns:e.columns,rowKey:function(e,t){return t},pagination:e.pagination,"data-source":e.data},on:{change:e.tableChange},scopedSlots:e._u([{key:"resourceStatus",fn:function(t){return r("span",{},[r("span",t?[r("span",{staticClass:"device-status",style:{background:"#15C937"}}),e._v("\n              启动")]:[r("span",{staticClass:"device-status",style:{background:"#C91521"}}),e._v("\n              停止")])])}},{key:"action",fn:function(t,s){return r("span",{},[r("span",{staticClass:"table-btn",on:{click:function(t){return e.listDetails(s)}}},[e._v("详情")]),e._v(" "),r("span",{staticClass:"table-btn",on:{click:function(t){return e.changeStatus(s)}}},[s.resourceStatus?r("span",[e._v("\n                停止")]):r("span",[e._v("\n                启动")])]),e._v(" "),r("span",{staticClass:"table-btn",on:{click:function(t){return e.editResource(s)}}},[e._v("修改")]),e._v(" "),r("a-popconfirm",{attrs:{title:"你确定删除此资源吗?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.deleteCancel(s.id)}}},[r("span",{staticClass:"table-btn"},[e._v(" 删除 ")])])],1)}}])})],1)]),e._v(" "),r("a-modal",{attrs:{width:800,title:e.resTitle},on:{ok:e.handleOk,cancel:e.closeHand},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("a-form-model",{ref:"resForm",attrs:{layout:"horizontal",model:e.resform,rules:e.rules}},[r("a-form-model-item",{attrs:{label:"资源类型",prop:"resourceType"}},[r("a-select",{attrs:{placeholder:"请选择资源类型"},model:{value:e.resform.resourceType,callback:function(t){e.$set(e.resform,"resourceType",t)},expression:"resform.resourceType"}},e._l(e.resourceList,function(t,s){return r("a-select-option",{key:s,attrs:{value:t.key}},[e._v("\n              "+e._s(t.title)+"\n            ")])}),1)],1),e._v(" "),r("a-form-model-item",{attrs:{label:"资源名称",prop:"resourceLabel"}},[r("a-input",{attrs:{placeholder:"请输入资源名称"},model:{value:e.resform.resourceLabel,callback:function(t){e.$set(e.resform,"resourceLabel",t)},expression:"resform.resourceLabel"}})],1),e._v(" "),r("a-divider"),e._v(" "),"RABBIT"===e.resform.resourceType?r("div",{staticClass:"form-flex"},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"RabbitMQ服务器地址",prop:"host"}},[r("a-input",{attrs:{placeholder:"请输入RabbitMQ服务器地址"},model:{value:e.resform.host,callback:function(t){e.$set(e.resform,"host",t)},expression:"resform.host"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"用户名",prop:"username"}},[r("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.resform.username,callback:function(t){e.$set(e.resform,"username",t)},expression:"resform.username"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"连接超时时间"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"input1",placeholder:"请输入连接超时时间"},model:{value:e.resform.connectTimeout,callback:function(t){e.$set(e.resform,"connectTimeout",t)},expression:"resform.connectTimeout"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"心跳间隔"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"keepLive",min:60,placeholder:"请输入心跳间隔"},model:{value:e.resform.keepLive,callback:function(t){e.$set(e.resform,"keepLive",t)},expression:"resform.keepLive"}})],1)],1),e._v(" "),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"RabbitMQ服务器端口",prop:"port"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"port",placeholder:"请输入RabbitMQ服务器端口"},model:{value:e.resform.port,callback:function(t){e.$set(e.resform,"port",t)},expression:"resform.port"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"密码"}},[r("a-input-password",{attrs:{placeholder:"请输入密码"},model:{value:e.resform.password,callback:function(t){e.$set(e.resform,"password",t)},expression:"resform.password"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"连接池大小",prop:"connectPoolSize"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"connectPoolSize",min:1e3,placeholder:"请输入连接池大小"},model:{value:e.resform.connectPoolSize,callback:function(t){e.$set(e.resform,"connectPoolSize",t)},expression:"resform.connectPoolSize"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"虚拟主机"}},[r("a-input",{attrs:{placeholder:"请输入虚拟主机"},model:{value:e.resform.virtualHost,callback:function(t){e.$set(e.resform,"virtualHost",t)},expression:"resform.virtualHost"}})],1)],1)],1)],1):e._e(),e._v(" "),"KAFKA"===e.resform.resourceType?r("div",{staticClass:"form-flex"},[r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"Kafka服务器"}},[r("a-input",{attrs:{placeholder:"请输入服务器地址"},model:{value:e.resform.host,callback:function(t){e.$set(e.resform,"host",t)},expression:"resform.host"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"Kafka用户名"}},[r("a-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.resform.username,callback:function(t){e.$set(e.resform,"username",t)},expression:"resform.username"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"异步调用超时时间"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"reqTimeout",min:1e3,placeholder:"请输入异步调用超时时间 "},model:{value:e.resform.reqTimeout,callback:function(t){e.$set(e.resform,"reqTimeout",t)},expression:"resform.reqTimeout"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"压缩类型"}},[r("a-select",{attrs:{placeholder:"请选择压缩类型"},model:{value:e.resform.compressionType,callback:function(t){e.$set(e.resform,"compressionType",t)},expression:"resform.compressionType"}},[r("a-select-option",{attrs:{value:"gzip"}},[e._v("\n                    gzip\n                  ")])],1)],1)],1),e._v(" "),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"Metadata更新间隔"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"metadataUpdateTime",min:60,placeholder:"请输入Metadata更新间隔"},model:{value:e.resform.metadataUpdateTime,callback:function(t){e.$set(e.resform,"metadataUpdateTime",t)},expression:"resform.metadataUpdateTime"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"Kafka密码"}},[r("a-input-password",{attrs:{placeholder:"Kafka认证密码"},model:{value:e.resform.password,callback:function(t){e.$set(e.resform,"password",t)},expression:"resform.password"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"最大批处理字节数"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"batchSize",min:0,placeholder:"最大批处理字节数"},model:{value:e.resform.batchSize,callback:function(t){e.$set(e.resform,"batchSize",t)},expression:"resform.batchSize"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"发送消息的缓冲区大小"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{id:"bufferSize",min:0,placeholder:"发送消息的缓冲区大小"},model:{value:e.resform.bufferSize,callback:function(t){e.$set(e.resform,"bufferSize",t)},expression:"resform.bufferSize"}})],1)],1)],1)],1):e._e(),e._v(" "),"HTTP"===e.resform.resourceType?r("div",{staticClass:"form-flex"},[r("a-form-model-item",{attrs:{label:"连接超时",prop:"connectTimeout"}},[r("a-input-number",{staticStyle:{width:"100%"},attrs:{value:10,min:10,placeholder:"请输入超时时间"},model:{value:e.resform.connectTimeout,callback:function(t){e.$set(e.resform,"connectTimeout",t)},expression:"resform.connectTimeout"}})],1),e._v(" "),r("a-form-model-item",{attrs:{label:"请求头"}},[r("div",[r("div",{staticClass:"form-head"},[r("div",{staticClass:"form-items"},[e._v("键")]),e._v(" "),r("div",{staticClass:"form-items"},[e._v("值")]),e._v(" "),r("div",{staticClass:"form-add",on:{click:e.addHeader}},[e._v("添加")])]),e._v(" "),r("div",{staticClass:"form-ipt"},e._l(e.headerArr,function(t,s){return r("a-row",{key:s,attrs:{gutter:16}},[r("a-col",{attrs:{span:10}},[r("a-input",{attrs:{placeholder:"请输入key"},model:{value:t.key,callback:function(r){e.$set(t,"key",r)},expression:"item.key"}})],1),e._v(" "),r("a-col",{attrs:{span:10}},[r("a-input",{attrs:{placeholder:"请输入value"},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}})],1),e._v(" "),r("a-col",{staticStyle:{"text-align":"center"},attrs:{span:4}},[r("span",{staticClass:"table-btn",on:{click:function(r){return e.deleteHeader(t)}}},[e._v("删除")])])],1)}),1)])]),e._v(" "),r("a-row",{attrs:{gutter:16}},[r("a-col",{attrs:{span:24}},[r("a-form-model-item",{attrs:{label:"请求URL",prop:"host"}},[r("a-input",{attrs:{placeholder:"请输入地址"},model:{value:e.resform.host,callback:function(t){e.$set(e.resform,"host",t)},expression:"resform.host"}})],1)],1)],1)],1):e._e()],1)],1),e._v(" "),r("a-modal",{attrs:{width:800,title:"资源信息"},on:{ok:e.detailsHandleOk},model:{value:e.detailVisible,callback:function(t){e.detailVisible=t},expression:"detailVisible"}},[r("a-descriptions",{attrs:{title:e.resDetail.resourceLabel}},[r("a-descriptions-item",{attrs:{label:"资源类型"}},[e._v("\n         "+e._s(e.resDetail.resourceType)+"\n        ")])],1),e._v(" "),"HTTP"===e.resDetail.resourceType?r("a-descriptions",{attrs:{bordered:"",column:2}},[r("a-descriptions-item",{attrs:{label:"超时时间"}},[e._v("\n          "+e._s(e.resDetail.connectTimeout)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"请求头"}},e._l(e.headerArr,function(t,s){return r("p",{key:s,staticStyle:{margin:"0"}},[r("span",[e._v(e._s(t.key)+":")]),e._v(" "),r("span",[e._v(e._s(t.value))])])}),0),e._v(" "),r("a-descriptions-item",{attrs:{label:"请求URL"}},[e._v("\n          "+e._s(e.resDetail.host)+"\n        ")])],1):e._e(),e._v(" "),"KAFKA"===e.resDetail.resourceType?r("a-descriptions",{attrs:{bordered:"",column:2}},[r("a-descriptions-item",{attrs:{label:"kafka服务器"}},[e._v("\n          "+e._s(e.resDetail.host)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"Metadata更新间隔"}},[e._v("\n          "+e._s(e.resDetail.metadataUpdateTime)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"Kafka用户名"}},[e._v("\n          "+e._s(e.resDetail.username)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"Kafka密码"}},[e._v("\n          "+e._s(e.resDetail.password)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"异步调用超时时间"}},[e._v("\n          "+e._s(e.resDetail.reqTimeout)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"最大批处理字节数"}},[e._v("\n          "+e._s(e.resDetail.batchSize)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"压缩类型"}},[e._v("\n          "+e._s(e.resDetail.compressionType)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"发送消息的缓冲区大小"}},[e._v("\n          "+e._s(e.resDetail.bufferSize)+"\n        ")])],1):e._e(),e._v(" "),"RABBIT"===e.resDetail.resourceType?r("a-descriptions",{attrs:{bordered:"",column:2}},[r("a-descriptions-item",{attrs:{label:"RabbitMQ服务器地址"}},[e._v("\n          "+e._s(e.resDetail.host)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"RabbitMQ服务器端口"}},[e._v("\n          "+e._s(e.resDetail.port)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"连接超时时间"}},[e._v("\n          "+e._s(e.resDetail.connectTimeout)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"连接池大小"}},[e._v("\n          "+e._s(e.resDetail.connectPoolSize)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"用户名"}},[e._v("\n          "+e._s(e.resDetail.username)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"密码"}},[e._v("\n          "+e._s(e.resDetail.password)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"心跳间隔"}},[e._v("\n          "+e._s(e.resDetail.keepLive)+"\n        ")]),e._v(" "),r("a-descriptions-item",{attrs:{label:"虚拟主机"}},[e._v("\n          "+e._s(e.resDetail.virtualHost)+"\n        ")])],1):e._e()],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"home-title"},[t("span",[this._v("资源管理")])])}]};var l=r("C7Lr")(i,n,!1,function(e){r("9H3s")},"data-v-6cf0bdc4",null);t.default=l.exports}});
//# sourceMappingURL=10.47feac0cf536d19d0d0e.js.map