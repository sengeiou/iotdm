webpackJsonp([13],{N32v:function(e,t){},S0r6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),s=a.n(i),c=[{dataIndex:"deviceStatus",title:"状态",ellipsis:!0,key:"deviceStatus",scopedSlots:{customRender:"deviceStatus"}},{dataIndex:"deviceLabel",title:"设备名称",ellipsis:!0,key:"deviceLabel"},{title:"设备标识码",dataIndex:"deviceCode",ellipsis:!0,key:"deviceCode"},{title:"设备ID",dataIndex:"id",ellipsis:!0,key:"id"},{title:"节点类型",dataIndex:"nodeType",ellipsis:!0,key:"nodeType",scopedSlots:{customRender:"nodeType"}},{title:"所属产品",key:"productLabel",ellipsis:!0,dataIndex:"productLabel"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],n={name:"equipmentList",data:function(){return{data:[],columns:c,searchObj:{key:"deviceLabel",value:"",deviceStatus:void 0},deviceCount:{TOTAL:0,INACTIVE:0,ONLINE:0},stateArr:[{value:"ONLINE",color:"#15C937",label:"在线"},{value:"WARN",color:"#C91521",label:"告警"},{value:"INACTIVE",color:"#beccfa",label:"未激活"},{value:"OFFLINE",color:"#C8421B",label:"离线"},{value:"STOP",color:"#C8A01B",label:"STOP"}],nodeArr:[{value:"GATEWAY",label:"直连设备"},{value:"ENDPOINT",label:"网关子设备"}],productArr:[],pagination:{showLessItems:!0,pageSizeOptions:["10","20","30"],showSizeChanger:!0,pageSize:10,current:1,hideOnSinglePage:!1,total:0},visible:!1,labelCol:{span:4},wrapperCol:{span:20},other:"",devform:{deviceLabel:"",confirmSecret:"",deviceCode:"",deviceSecret:"",productId:"",authType:"SECRET"},rules:{productId:[{required:!0,message:"请选择或搜素产品",trigger:"blur"}],deviceCode:[{required:!0,message:"请输入设备标识码",trigger:"change"},{validator:this.$validator.checkCode,message:"不可输入中文",trigger:["blur","change"]}],deviceSecret:[{validator:this.$validator.checkCode,message:"不可输入中文",trigger:["blur","change"]}],confirmSecret:[{validator:this.$validator.checkCode,message:"不可输入中文",trigger:["blur","change"]}]}}},created:function(){this.getList(),this.getDeviceNumber()},methods:{tableChange:function(e){this.pagination.pageSize=e.pageSize,this.pagination.current=e.current,this.pagination.total=e.total,this.getList()},getList:function(){var e=this,t={searchKey:this.searchObj.key,searchValue:this.searchObj.val,deviceStatus:this.searchObj.deviceStatus,page:this.pagination.current,pageSize:this.pagination.pageSize};this.$api.getDeviceLis(t).then(function(t){var a=t.data;e.pagination.total=a.total,e.pagination.pageSize=a.size,e.pagination.current=a.current;var i=a.records;e.data=i})},getDeviceNumber:function(){var e=this;this.$api.getCountDevice({productId:""}).then(function(t){e.deviceCount=t.data})},getProductList:function(){var e=this;this.$api.getProductAllList({limit:"",productLabel:""}).then(function(t){e.productArr=t.data})},productSearch:function(e){var t=this,a={limit:"",productLabel:e};this.$api.getProductAllList(a).then(function(e){t.productArr=e.data})},showModal:function(){this.visible=!0,this.devform={authType:"SECRET"},this.getProductList()},handleOk:function(){var e=this;this.$refs.devForm.validate(function(t){t&&e.$api.postDevice(e.devform).then(function(t){e.visible=!1,e.getList()})})},closeHandle:function(){this.visible=!1,this.$refs.devForm.resetFields()},deleteCancel:function(e){var t=this;this.$api.deleteDevice(e).then(function(e){t.getList()})},onSearch:function(){this.getList()},goDetail:function(e,t){this.$router.push({path:"/equipmentDetails",query:{id:e,productId:t}})},goDebug:function(e){var t=s()(e);this.$router.push({path:"/online",query:{deviceObj:t}})},changeStatus:function(e){var t=this,a={deviceId:e.id,deviceStatus:e.deviceStatus};this.$api.putDeviceStatus(a).then(function(e){t.getList()})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._m(0),e._v(" "),a("div",{staticClass:"table-content"},[a("div",[a("div",{staticClass:"device-list"},[a("div",{staticClass:"device-item",staticStyle:{"text-align":"left"}},[a("p",[a("span",{staticClass:"device-num",staticStyle:{color:"#1067EE"}},[e._v(" "+e._s(e.deviceCount.TOTAL))]),e._v(" "),a("span",{staticClass:"device-unit"},[e._v("台")])]),e._v(" "),a("p",{staticClass:"devive-numtitle"},[e._v("当前设备总数")])]),e._v(" "),a("a-divider",{staticStyle:{height:"47px","margin-top":"20px"},attrs:{type:"vertical"}}),e._v(" "),a("div",{staticClass:"device-item"},[a("p",[a("span",{staticClass:"device-num",staticStyle:{color:"#44D7B6"}},[e._v(" "+e._s(e.deviceCount.TOTAL-e.deviceCount.INACTIVE))]),e._v(" "),a("span",{staticClass:"device-unit"},[e._v("台")])]),e._v(" "),a("p",{staticClass:"devive-numtitle"},[e._v("激活设备数")])]),e._v(" "),a("a-divider",{staticStyle:{height:"47px","margin-top":"20px"},attrs:{type:"vertical"}}),e._v(" "),a("div",{staticClass:"device-item"},[a("p",[a("span",{staticClass:"device-num"},[e._v(" "+e._s(e.deviceCount.ONLINE))]),e._v(" "),a("span",{staticClass:"device-unit"},[e._v("台")])]),e._v(" "),a("p",{staticClass:"devive-numtitle"},[e._v("在线设备")])])],1)]),e._v(" "),a("div",{staticClass:"table-title"},[a("a-button",{attrs:{type:"primary"},on:{click:e.showModal}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" 注册设备")],1),e._v(" "),a("a-select",{staticStyle:{width:"200px",margin:"0 20px"},attrs:{placeholder:"请选择设备状态",allowClear:!0},on:{search:e.onSearch,change:e.onSearch},model:{value:e.searchObj.deviceStatus,callback:function(t){e.$set(e.searchObj,"deviceStatus",t)},expression:"searchObj.deviceStatus"}},e._l(e.stateArr,function(t,i){return a("a-select-option",{key:i,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])}),1),e._v(" "),a("div",[a("a-select",{staticStyle:{width:"100px"},model:{value:e.searchObj.key,callback:function(t){e.$set(e.searchObj,"key",t)},expression:"searchObj.key"}},[a("a-select-option",{attrs:{value:"deviceLabel"}},[e._v("\n            设备名称\n          ")]),e._v(" "),a("a-select-option",{attrs:{value:"deviceCode"}},[e._v("\n            设备标识码\n          ")]),e._v(" "),a("a-select-option",{attrs:{value:"id"}},[e._v("\n            设备ID\n          ")])],1),e._v(" "),a("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"请搜索"},on:{search:e.onSearch},model:{value:e.searchObj.val,callback:function(t){e.$set(e.searchObj,"val",t)},expression:"searchObj.val"}})],1)],1),e._v(" "),a("div",{staticClass:"table-box"},[a("a-table",{attrs:{columns:e.columns,rowKey:function(e,t){return t},pagination:e.pagination,"data-source":e.data},on:{change:e.tableChange},scopedSlots:e._u([{key:"deviceStatus",fn:function(t){return a("span",{},e._l(e.stateArr,function(i,s){return i.value===t?a("span",{key:s},[a("span",{staticClass:"device-status",style:{background:i.color}}),e._v("\n            "+e._s(i.label)+"\n          ")]):e._e()}),0)}},{key:"nodeType",fn:function(t){return a("span",{},e._l(e.nodeArr,function(i,s){return i.value===t?a("span",{key:s},[e._v("\n            "+e._s(i.label)+"\n          ")]):e._e()}),0)}},{key:"action",fn:function(t,i){return a("span",{},[a("span",{staticClass:"table-btn",on:{click:function(t){return e.goDetail(i.id,i.productId)}}},[e._v("查看")]),e._v(" "),a("a-popconfirm",{attrs:{"ok-text":"确定","cancel-text":"取消"},on:{confirm:function(t){return e.deleteCancel(i.id)}}},[a("a-icon",{staticStyle:{display:"none"},attrs:{slot:"icon",type:"question-circle-o"},slot:"icon"}),e._v(" "),a("template",{slot:"title"},[a("a-alert",{attrs:{message:"您确认删除此设备吗？请注意：",type:"warning","show-icon":""}},[a("div",{attrs:{slot:"description"},slot:"description"},[a("p",[e._v("1、操作不可撤回：删除后此设备的数据及关联资源将同步删除；")]),e._v(" "),a("p",[e._v("2、删除后，对应的真实设备需重新关联平台其他设备，才能再次接入平台")])])])],1),e._v(" "),a("span",{staticClass:"table-btn"},[e._v(" 删除 ")])],2),e._v(" "),a("span",{staticClass:"table-btn",on:{click:function(t){return e.goDebug(i)}}},[e._v("调试")]),e._v(" "),a("span",{staticClass:"table-btn",on:{click:function(t){return e.changeStatus(i)}}},["STOP"!==i.deviceStatus?a("span",[e._v("\n          冻结\n        ")]):a("span",[e._v("\n          启动\n        ")])])],1)}}])})],1)]),e._v(" "),a("a-modal",{attrs:{width:700,title:"单设备注册"},on:{ok:e.handleOk,cancel:e.closeHandle},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form-model",{ref:"devForm",attrs:{model:e.devform,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{attrs:{label:"所属产品",prop:"productId"}},[a("a-select",{attrs:{"show-search":"",placeholder:"请选择或搜索产品","option-filter-prop":"children"},on:{search:e.productSearch},model:{value:e.devform.productId,callback:function(t){e.$set(e.devform,"productId",t)},expression:"devform.productId"}},e._l(e.productArr,function(t,i){return a("a-select-option",{key:i,attrs:{value:t.id}},[e._v("\n            "+e._s(t.productLabel)+"\n          ")])}),1)],1),e._v(" "),a("a-form-model-item",{ref:"deviceCode",attrs:{label:"设备标识码",prop:"deviceCode"}},[a("a-input",{attrs:{placeholder:"请输入设备标识码"},model:{value:e.devform.deviceCode,callback:function(t){e.$set(e.devform,"deviceCode",t)},expression:"devform.deviceCode"}})],1),e._v(" "),a("a-form-model-item",{ref:"deviceLabel",attrs:{label:"设备名称"}},[a("a-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.devform.deviceLabel,callback:function(t){e.$set(e.devform,"deviceLabel",t)},expression:"devform.deviceLabel"}})],1),e._v(" "),a("a-form-model-item",{ref:"authType",attrs:{label:"设备认证类型"}},[a("a-radio-group",{model:{value:e.devform.authType,callback:function(t){e.$set(e.devform,"authType",t)},expression:"devform.authType"}},[a("a-radio",{attrs:{value:"SECRET",checked:""}},[e._v("\n            密钥\n          ")])],1)],1),e._v(" "),a("a-form-model-item",{attrs:{label:"密钥"}},[a("a-input-password",{attrs:{placeholder:"请输入密钥"},model:{value:e.devform.deviceSecret,callback:function(t){e.$set(e.devform,"deviceSecret",t)},expression:"devform.deviceSecret"}})],1),e._v(" "),a("a-form-model-item",{attrs:{label:"确认密钥"}},[a("a-input-password",{attrs:{placeholder:"请再次输入密钥"},model:{value:e.devform.confirmSecret,callback:function(t){e.$set(e.devform,"confirmSecret",t)},expression:"devform.confirmSecret"}})],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"home-title"},[t("span",[this._v("设备管理")])])}]};var o=a("C7Lr")(n,l,!1,function(e){a("N32v")},"data-v-173d6d4e",null);t.default=o.exports}});
//# sourceMappingURL=13.81c59fc25d9c21932139.js.map